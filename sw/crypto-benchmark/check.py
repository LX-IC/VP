import sys, binascii
benchmark_name = "SM3"
#
# test 1/5
input_len       = 0
input_data      = binascii.a2b_hex("")
actual_digest   = binascii.a2b_hex("1ab21d8355cfa17f8e61194831e81a8f22bec8c728fefb747ed035eb5082aa2b")
instr_count     = 0x0000000000000a71
testnum         = 1
ipb             = 0 if input_len == 0 else instr_count / input_len
expected_digest = binascii.a2b_hex("1ab21d8355cfa17f8e61194831e81a8f22bec8c728fefb747ed035eb5082aa2b")
if( actual_digest  != expected_digest ):
    print("Test 0 failed.")
    print( 'input     == %s' % ( binascii.b2a_hex( input_data ) ) )
    print( 'actual_digest == %s' % ( binascii.b2a_hex( actual_digest ) ) )
    print( '          != %s' % ( binascii.b2a_hex( expected_digest ) ) )
    sys.exit(1)
else:
    print("SM3 Test %d passed. %d instrs / %d bytes. IPB=%f" % (testnum,instr_count,input_len,ipb))
#
# test 2/5
input_len       = 3
input_data      = binascii.a2b_hex("616263")
actual_digest   = binascii.a2b_hex("66c7f0f462eeedd9d1f2d46bdc10e4e24167c4875cf2f7a2297da02b8f4ba8e0")
instr_count     = 0x0000000000000a98
testnum         = 2
ipb             = 0 if input_len == 0 else instr_count / input_len
expected_digest = binascii.a2b_hex("66c7f0f462eeedd9d1f2d46bdc10e4e24167c4875cf2f7a2297da02b8f4ba8e0")
if( actual_digest  != expected_digest ):
    print("Test 1 failed.")
    print( 'input     == %s' % ( binascii.b2a_hex( input_data ) ) )
    print( 'actual_digest == %s' % ( binascii.b2a_hex( actual_digest ) ) )
    print( '          != %s' % ( binascii.b2a_hex( expected_digest ) ) )
    sys.exit(1)
else:
    print("SM3 Test %d passed. %d instrs / %d bytes. IPB=%f" % (testnum,instr_count,input_len,ipb))
#
# test 3/5
input_len       = 60
input_data      = binascii.a2b_hex("4c435371476c7056714f5266616b535556635857444f556a516555574565414d716d4d454c36463835674d336661424365706e466d37625754464434")
actual_digest   = binascii.a2b_hex("449e07b6a7ceaf7f1fadd927acf8a950539e292473d46cfcd004b9cdb6166d64")
instr_count     = 0x0000000000001423
testnum         = 3
ipb             = 0 if input_len == 0 else instr_count / input_len
expected_digest = binascii.a2b_hex("449e07b6a7ceaf7f1fadd927acf8a950539e292473d46cfcd004b9cdb6166d64")
if( actual_digest  != expected_digest ):
    print("Test 2 failed.")
    print( 'input     == %s' % ( binascii.b2a_hex( input_data ) ) )
    print( 'actual_digest == %s' % ( binascii.b2a_hex( actual_digest ) ) )
    print( '          != %s' % ( binascii.b2a_hex( expected_digest ) ) )
    sys.exit(1)
else:
    print("SM3 Test %d passed. %d instrs / %d bytes. IPB=%f" % (testnum,instr_count,input_len,ipb))
#
# test 4/5
input_len       = 72
input_data      = binascii.a2b_hex("48487238737939384e7a7a714d3478776d6858613535454d7562635348633877644678734d6844434c783545696b6e767941395339714b753551346957767845486e4f704c54754b")
actual_digest   = binascii.a2b_hex("92a2584527643298f8e665cee4254caf1dc0a4affa2369ed9fba6edf6369ce9b")
instr_count     = 0x00000000000014cf
testnum         = 4
ipb             = 0 if input_len == 0 else instr_count / input_len
expected_digest = binascii.a2b_hex("92a2584527643298f8e665cee4254caf1dc0a4affa2369ed9fba6edf6369ce9b")
if( actual_digest  != expected_digest ):
    print("Test 3 failed.")
    print( 'input     == %s' % ( binascii.b2a_hex( input_data ) ) )
    print( 'actual_digest == %s' % ( binascii.b2a_hex( actual_digest ) ) )
    print( '          != %s' % ( binascii.b2a_hex( expected_digest ) ) )
    sys.exit(1)
else:
    print("SM3 Test %d passed. %d instrs / %d bytes. IPB=%f" % (testnum,instr_count,input_len,ipb))
#
# test 5/5
input_len       = 5978
input_data      = binascii.a2b_hex("4f4253446c704c784c4e4d336267435a6943357671436162536854586e775466654a526e49624f69576f6a6d5975395665733764464a764757657243673849724c754e316e486b755939784f4a684167614d5455306b6b49486933556c734e4c773734457a6a6d5a334365317462576d7873726c6a4f73553472654935376b4c713535534776505267626c367851776853635a734e3761454756316638505657343161435072343533664b50506e595a536249326535416572356a464d304d794f543231394277717a454b616c48433670456c776c4a453744464a5a45476955706c39637462414b515578756159554666457a52614c6f49353450735154385535474b4f544d56675170763078457246476765714f4f7a5a396870374541494c76384a6a6c5a5a434e624b436869415a6458516e41766632557a357779654a4b6867393559584e793668573176525a6745496f4c6433464d657a796978573341416b55544c706554694c6e446779596561476b5a7144463847684874335a6f71654b4352505a333662674d72394e79375172444644457a726770327261644755557259474b7077707235736d6f417147494d4847636b75614d4e753156436a68775a7050554e6474384554786d49624f447344786754474e4c3550314e62664536567673464257544f477575665666364d6c3166525344336a79744e7937614c63484e6d32776d66394962577a744f597766727a35366f6d746d5964546c306461736461734f4253446c704c784c4e4d336267435a6943357671436162536854586e775466654a526e49624f69576f6a6d5975395665733764464a764757657243673849724c754e316e486b755939784f4a684167614d5455306b6b49486933556c734e4c773734457a6a6d5a334365317462576d7873726c6a4f73553472654935376b4c713535534776505267626c367851776853635a734e3761454756316638505657343161435072343533664b50506e595a536249326535416572356a464d304d794f543231394277717a454b616c48433670456c776c4a453744464a5a45476955706c39637462414b515578756159554666457a52614c6f49353450735154385535474b4f544d56675170763078457246476765714f4f7a5a396870374541494c76384a6a6c5a5a434e624b436869415a6458516e41766632557a357779654a4b6867393559584e793668573176525a6745496f4c6433464d657a796978573341416b55544c706554694c6e446779596561476b5a7144463847684874335a6f71654b4352505a333662674d72394e79375172444644457a726770327261644755557259474b7077707235736d6f417147494d4847636b75614d4e753156436a68775a7050554e6474384554786d49624f447344786754474e4c3550314e62664536567673464257546d6f417147494d4847636b75614d4e753156436a68775a7050554e6474384554786d49624f447344786754474e4c3550314e62664536567673464257544f477575665666364d6c3166525344336a79744e7937614c63484e6d32776d66394962577a744f597766727a35366f6d746d5964546c306461736461734f4253446c704c784c4e4d336267435a6943357671436162536854586e775466654a526e49624f69576f6a6d5975395665733764464a764757657243673849724c754e316e486b755939784f4a684167614d5455306b6b49486933556c734e4c773734457a6a6d5a334365317462576d7873726c6a4f73553472654935376b4c713535534776505267626c367851776853635a734e3761454756316638505657343161435072343533664b50506e595a536249326535416572356a464d304d794f543231394277717a454b616c48433670456c776c4a453744464a5a45476955706c39637462414b515578756159554666457a52614c6f49353450735154385535474b4f544d56675170763078457246476765714f4f7a5a396870374541494c76384a6a6c5a5a434e624b436869415a6458516e41766632557a357779654a4b6867393559584e793668573176525a6745496f4c6433464d657a796978573341416b55544c706554694c6e446779596561476b5a7144463847684874335a6f71654b4352505a333662674d72394e79375172444644457a726770327261644755557259474b7077707235736d6f417147494d4847636b75614d4e753156436a68775a7050554e6474384554786d49624f447344786754474e4c3550314e62664536567673464257546d6f417147494d4847636b75614d4e753156436a68775a7050554e6474384554786d49624f447344786754474e4c3550314e62664536567673464257544f477575665666364d6c3166525344336a79744e7937614c63484e6d32776d66394962577a744f597766727a35366f6d746d5964546c306461736461734f4253446c704c784c4e4d336267435a6943357671436162536854586e775466654a526e49624f69576f6a6d5975395665733764464a764757657243673849724c754e316e486b755939784f4a684167614d5455306b6b49486933556c734e4c773734457a6a6d5a334365317462576d7873726c6a4f73553472654935376b4c713535534776505267626c367851776853635a734e3761454756316638505657343161435072343533664b50506e595a536249326535416d6f417147494d4847636b75614d4e753156436a68775a7050554e6474384554786d49624f447344786754474e4c3550314e62664536567673464257546d6f417147494d4847636b75614d4e753156436a68775a7050554e6474384554786d49624f447344786754474e4c3550314e62664536567673464257544f477575665666364d6c3166525344336a79744e7937614c63484e6d32776d66394962577a744f597766727a35366f6d746d5964546c306461736461734f4253446c704c784c4e4d336267435a6943357671436162536854586e775466654a526e49624f69576f6a6d5975395665733764464a764757657243673849724c754e316e486b755939784f4a684167614d5455306b6b49486933556c734e4c773734457a6a6d5a334365317462576d7873726c6a4f73553472654935376b4c713535534776505267626c367851776853635a734e3761454756316638505657343161435072343533664b50506e595a536249326535416572356a464d304d794f543231394277717a454b616c48433670456c776c4a453744464a5a45476955706c39637462414b515578756159554666457a52614c6f49353450735154385535474b4f544d56675170763078457246476765714f4f7a5a396870374541494c76384a6a6c5a5a434e624b436869415a6458516e41766632557a357779654a4b6867393559584e793668573176525a6745496f4c6433464d657a796978573341416b55544c706554694c6e446779596561476b5a7144463847684874335a6f71654b4352505a333662674d72394e79375172444644457a726770327261644755557259474b7077707235736d6f417147494d4847636b75614d4e753156436a68775a7050554e6474384554786d49624f447344786754474e4c3550314e62664536567673464257544f477575665666364d6c3166525344336a79744e7937614c63484e6d32776d66394962577a744f597766727a35366f6d746d5964546c306461736461734f4253446c704c784c4e4d336267435a6943357671436162536854586e775466654a526e49624f69576f6a6d5975395665733764464a764757657243673849724c754e316e486b755939784f4a684167614d5455306b6b49486933556c734e4c773734457a6a6d5a334365317462576d7873726c6a4f73553472654935376b4c713535534776505267626c367851776853635a734e3761454756316638505657343161435072343533664b50506e595a536249326535416572356a464d304d794f543231394277717a454b616c48433670456c776c4a453744464a5a45476955706c39637462414b515578756159554666457a52614c6f49353450735154385535474b4f544d56675170763078457246476765714f4f7a5a396870374541494c76384a6a6c5a5a434e624b436869415a6458516e41766632557a357779654a4b6867393559584e793668573176525a6745496f4c6433464d657a796978573341416b55544c706554694c6e446779596561476b5a7144463847684874335a6f71654b4352505a333662674d72394e79375172444644457a726770327261644755557259474b7077707235736d6f417147494d4847636b75614d4e753156436a68775a7050554e6474384554786d49624f447344786754474e4c3550314e62664536567673464257546572356a464d304d794f543231394277717a454b616c48433670456c776c4a453744464a5a45476955706c39637462414b515578756159554666457a52614c6f49353450735154385535474b4f544d56675170763078457246476765714f4f7a5a396870374541494c76384a6a6c5a5a434e624b436869415a6458516e41766632557a357779654a4b6867393559584e793668573176525a6745496f4c6433464d657a796978573341416b55544c706554694c6e446779596561476b5a7144463847684874335a6f71654b4352505a333662674d72394e79375172444644457a726770327261644755557259474b7077707235736d6f417147494d4847636b75614d4e753156436a68775a7050554e6474384554786d49624f447344786754474e4c3550314e62664536567673464257546d6f417147494d4847636b75614d4e753156436a68775a7050554e6474384554786d49624f447344786754474e4c3550314e62664536567673464257546d6f417147494d4847636b75614d4e753156436a68775a7050554e6474384554786d49624f447344786754474e4c3550314e62664536567673464257544f477575665666364d6c3166525344336a79744e7937614c63484e6d32776d66394962577a744f597766727a35366f6d746d5964546c306461736461734f4253446c704c784c4e4d336267435a6943357671436162536854586e775466654a526e49624f69576f6a6d5975395665733764464a764757657243673849724c754e316e486b755939784f4a684167614d5455306b6b49486933556c734e4c773734457a6a6d5a334365317462576d7873726c6a4f73553472654935376b4c713535534776505267626c367851776853635a734e3761454756316638505657343161435072343533664b50506e595a536249326535416572356a464d304d794f543231394277717a454b616c48433670456c776c4a453744464a5a45476955706c39637462414b515578756159554666457a52614c6f49353450735154385535474b4f544d56675170763078457246476765714f4f7a5a396870374541494c76384a6a6c5a5a434e624b436869415a6458516e41766632557a357779654a4b6867393559584e793668573176525a6745496f4c6433464d657a796978573341416b55544c706554694c6e446779596561476b5a7144463847684874335a6f71654b4352505a333662674d72394e79375172444644457a726770327261644755557259474b7077707235736d6f417147494d4847636b75614d4e753156436a68775a7050554e6474384554786d49624f447344786754474e4c3550314e62664536567673464257544f477575665666364d6c3166525344336a79744e7937614c63484e6d32776d66394962577a744f597766727a35366f6d746d5964546c306461736461734f4253446c704c784c4e4d336267435a6943357671436162536854586e775466654a526e49624f69576f6a6d5975395665733764464a764757657243673849724c754e316e486b755939784f4a684167614d5455306b6b49486933556c734e4c773734457a6a6d5a334365317462576d7873726c6a4f73553472654935376b4c713535534776505267626c367851776853635a734e3761454756316638505657343161435072343533664b50506e595a536249326535416572356a464d304d794f543231394277717a454b616c48433670456c776c4a453744464a5a45476955706c39637462414b515578756159554666457a52614c6f49353450735154385535474b4f544d56675170763078457246476765714f4f7a5a396870374541494c76384a6a6c5a5a434e624b436869415a6458516e41766632557a357779654a4b6867393559584e793668573176525a6745496f4c6433464d657a796978573341416b55544c706554694c6e446779596561476b5a7144463847684874335a6f71654b4352505a333662674d72394e79375172444644457a726770327261644755557259474b7077707235736d6f417147494d4847636b75614d4e753156436a68775a7050554e6474384554786d49624f447344786754474e4c3550314e62664536567673464257544f477575665666364d6c3166525344336a79744e7937614c63484e6d32776d66394962577a744f597766727a35366f6d746d5964546c306461736461734f4253446c704c784c4e4d336267435a6943357671436162536854586e775466654a526e49624f69576f6a6d5975395665733764464a764757657243673849724c754e316e486b755939784f4a684167614d5455306b6b49486933556c734e4c773734457a6a6d5a334365317462576d7873726c6a4f73553472654935376b4c713535534776505267626c367851776853635a734e3761454756316638505657343161435072343533664b50506e595a536249326535416572356a464d304d794f543231394277717a454b616c48433670456c776c4a453744464a5a45476955706c39637462414b515578756159554666457a52614c6f49353450735154385535474b4f544d56675170763078457246476765714f4f7a5a396870374541494c76384a6a6c5a5a434e624b436869415a6458516e41766632557a357779654a4b6867393559584e793668573176525a6745496f4c6433464d657a796978573341416b55544c706554694c6e446779596561476b5a7144463847684874335a6f71654b4352505a333662674d72394e79375172444644457a726770327261644755557259474b7077707235736d6f417147494d4847636b75614d4e753156436a68775a7050554e6474384554786d49624f447344786754474e4c3550314e62664536567673464257546d6f417147494d4847636b75614d4e753156436a68775a7050554e6474384554786d49624f447344786754474e4c3550314e62664536567673464257546d6f417147494d4847636b75614d4e753156436a68775a7050554e6474384554786d49624f447344786754474e4c3550314e62664536567673464257544f477575665666364d6c3166525344336a79744e7937614c63484e6d32776d66394962577a744f597766727a35366f6d746d5964546c306461736461734f4253446c704c784c4e4d336267435a6943357671436162536854586e775466654a526e49624f69576f6a6d5975395665733764464a764757657243673849724c754e316e486b755939784f4a684167614d5455306b6b49486933556c734e4c773734457a6a6d5a334365317462576d7873726c6a4f73553472654935376b4c713535534776505267626c367851776853635a734e3761454756316638505657343161435072343533664b50506e595a536249326535416572356a464d304d794f543231394277717a454b616c48433670456c776c4a453744464a5a45476955706c39637462414b515578756159554666457a52614c6f49353450735154385535474b4f544d56675170763078457246476765714f4f7a5a396870374541494c76384a6a6c5a5a434e624b436869415a6458516e41766632557a357779654a4b6867393559584e793668573176525a6745496f4c6433464d657a796978573341416b55544c706554694c6e446779596561476b5a7144463847684874335a6f71654b4352505a333662674d72394e79375172444644457a726770327261644755557259474b7077707235736d6f417147494d4847636b75614d4e753156436a68775a7050554e6474384554786d49624f447344786754474e4c3550314e62664536567673464257544f477575665666364d6c3166525344336a79744e7937614c63484e6d32776d66394962577a744f597766727a35366f6d746d5964546c30647361646173")
actual_digest   = binascii.a2b_hex("04a168863b4b3b1711b7609aea16c3c0c25a0ac1f474e17f4f3cbeade6681de9")
instr_count     = 0x000000000003aa2b
testnum         = 5
ipb             = 0 if input_len == 0 else instr_count / input_len
expected_digest = binascii.a2b_hex("04a168863b4b3b1711b7609aea16c3c0c25a0ac1f474e17f4f3cbeade6681de9")
if( actual_digest  != expected_digest ):
    print("Test 4 failed.")
    print( 'input     == %s' % ( binascii.b2a_hex( input_data ) ) )
    print( 'actual_digest == %s' % ( binascii.b2a_hex( actual_digest ) ) )
    print( '          != %s' % ( binascii.b2a_hex( expected_digest ) ) )
    sys.exit(1)
else:
    print("SM3 Test %d passed. %d instrs / %d bytes. IPB=%f" % (testnum,instr_count,input_len,ipb))
